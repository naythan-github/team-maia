{
  "dashboard": {
    "id": null,
    "uid": "servicedesk-sentiment-team-performance",
    "title": "Dashboard 7: Customer Sentiment & Team Performance",
    "tags": [
      "servicedesk",
      "sentiment",
      "performance",
      "customer-satisfaction",
      "team-ranking"
    ],
    "timezone": "browser",
    "schemaVersion": 38,
    "version": 0,
    "refresh": "5m",
    "time": {
      "from": "2025-07-01T00:00:00.000Z",
      "to": "now"
    },
    "timepicker": {
      "refresh_intervals": [
        "5m",
        "15m",
        "30m",
        "1h"
      ]
    },
    "editable": true,
    "fiscalYearStartMonth": 0,
    "graphTooltip": 1,
    "panels": [
      {
        "id": 999,
        "type": "text",
        "title": "\ud83d\udcd8 Dashboard Guide",
        "gridPos": {
          "h": 4,
          "w": 24,
          "x": 0,
          "y": 0
        },
        "options": {
          "mode": "markdown",
          "content": "**Dashboard Purpose**: Analyze customer sentiment and team performance using AI-powered sentiment analysis combined with SLA, response time, and quality metrics.\n\n**Key Metrics**:\n- **LLM Sentiment Analysis**: Google DeepMind's gemma2:9b model (83% accuracy) analyzes customer comments for positive/negative/neutral/mixed sentiment\n- **Team Performance Score**: Composite metric combining SLA compliance (30%), response speed (30%), and positive sentiment rate (40%)\n- **Quality Metrics**: AI-powered quality scoring (professionalism, clarity, empathy, actionability)\n\n**Time Range**: July 2025 - Present | **Refresh**: Every 5 minutes\n\n**Use Cases**: Identify top performers, track sentiment trends, improve customer satisfaction, prioritize training needs"
        },
        "transparent": false,
        "fieldConfig": {
          "defaults": {},
          "overrides": []
        }
      },
      {
        "id": 100,
        "type": "row",
        "title": "Overall Sentiment Metrics",
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 4
        },
        "collapsed": false
      },
      {
        "id": 1,
        "type": "stat",
        "title": "Total Customer-Facing Comments",
        "description": "Total number of comments visible to customers since July 2025. Excludes internal notes and system-generated comments.",
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 0,
          "y": 5
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT COUNT(*) as value\nFROM servicedesk.comments\nWHERE visible_to_customer = 'Yes'\nAND created_time >= '2025-07-01';",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "blue"
                }
              ]
            },
            "unit": "short"
          }
        },
        "options": {
          "graphMode": "area",
          "textMode": "value_and_name",
          "colorMode": "background"
        }
      },
      {
        "id": 2,
        "type": "stat",
        "title": "Positive Sentiment Rate (Keyword)",
        "description": "Legacy keyword-based sentiment detection (32% accuracy). Counts comments containing words like 'thank', 'great', 'excellent'. Superseded by LLM analysis.",
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 6,
          "y": 5
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  CAST(SUM(CASE WHEN LOWER(comment_text) ~ '.*(thank|great|excellent|happy|appreciate|wonderful|fantastic|perfect|amazing).*' THEN 1 ELSE 0 END)*100.0/COUNT(*) AS NUMERIC(10,1)) as value\nFROM servicedesk.comments\nWHERE visible_to_customer = 'Yes'\nAND created_time >= '2025-07-01';",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "red"
                },
                {
                  "value": 30,
                  "color": "yellow"
                },
                {
                  "value": 50,
                  "color": "green"
                }
              ]
            },
            "unit": "percent"
          }
        },
        "options": {
          "graphMode": "area",
          "textMode": "value_and_name",
          "colorMode": "background"
        }
      },
      {
        "id": 3,
        "type": "stat",
        "title": "Average Team SLA Compliance",
        "description": "Overall SLA compliance rate across all team members. Target: >95% compliance for optimal customer satisfaction.",
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 12,
          "y": 5
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  CAST(SUM(CASE WHEN \"TKT-SLA Met\" = 'yes' THEN 1 ELSE 0 END)*100.0/COUNT(*) AS NUMERIC(10,1)) as value\nFROM servicedesk.tickets\nWHERE \"TKT-Team\" IN ('${team:raw}') AND \"TKT-Created Time\" >= '2025-07-01'\nAND \"TKT-SLA Met\" IS NOT NULL\nAND \"TKT-Assigned To User\" NOT LIKE ' %';",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "red"
                },
                {
                  "value": 85,
                  "color": "yellow"
                },
                {
                  "value": 95,
                  "color": "green"
                }
              ]
            },
            "unit": "percent"
          }
        },
        "options": {
          "graphMode": "area",
          "textMode": "value_and_name",
          "colorMode": "background"
        }
      },
      {
        "id": 4,
        "type": "stat",
        "title": "Average Comment Quality Score",
        "description": "AI-powered quality assessment (1.0-3.0 scale) measuring professionalism, clarity, empathy, and actionability. Based on llama3.1:8b analysis.",
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 18,
          "y": 5
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  CAST(AVG(quality_score) AS NUMERIC(10,2)) as value\nFROM servicedesk.comment_quality\nWHERE created_time >= '2025-07-01';",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "red"
                },
                {
                  "value": 2.0,
                  "color": "yellow"
                },
                {
                  "value": 3.0,
                  "color": "green"
                }
              ]
            },
            "unit": "short",
            "decimals": 2
          }
        },
        "options": {
          "graphMode": "area",
          "textMode": "value_and_name",
          "colorMode": "background"
        }
      },
      {
        "id": 102,
        "type": "row",
        "title": "LLM Sentiment Analysis (gemma2:9b - 78% accuracy)",
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 9
        },
        "collapsed": false
      },
      {
        "id": 10,
        "type": "stat",
        "title": "LLM Positive Sentiment Rate",
        "description": "AI-powered positive sentiment rate using gemma2:9b model (83% accuracy, +51% improvement over keywords). Analyzes actual comment meaning, not just keywords.",
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 0,
          "y": 10
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  CAST(SUM(CASE WHEN sentiment = 'positive' THEN 1 ELSE 0 END)*100.0/COUNT(*) AS NUMERIC(10,1)) as value\nFROM servicedesk.comment_sentiment\nWHERE created_time >= '2025-07-01';",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "red"
                },
                {
                  "value": 40,
                  "color": "yellow"
                },
                {
                  "value": 60,
                  "color": "green"
                }
              ]
            },
            "unit": "percent"
          }
        },
        "options": {
          "graphMode": "area",
          "textMode": "value_and_name",
          "colorMode": "background"
        }
      },
      {
        "id": 11,
        "type": "piechart",
        "title": "LLM Sentiment Distribution",
        "description": "Pie chart showing sentiment breakdown from LLM analysis: Positive (appreciation/success), Negative (frustration/failure), Neutral (informational/ongoing), Mixed (both positive and negative elements).",
        "gridPos": {
          "h": 8,
          "w": 8,
          "x": 6,
          "y": 10
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  sentiment as metric,\n  COUNT(*) as value\nFROM servicedesk.comment_sentiment\nWHERE created_time >= '2025-07-01'\nGROUP BY sentiment\nORDER BY value DESC;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "palette-classic"
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "positive"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "mode": "fixed",
                    "fixedColor": "green"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "negative"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "mode": "fixed",
                    "fixedColor": "red"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "neutral"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "mode": "fixed",
                    "fixedColor": "blue"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "mixed"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "mode": "fixed",
                    "fixedColor": "orange"
                  }
                }
              ]
            }
          ]
        },
        "options": {
          "reduceOptions": {
            "values": false,
            "calcs": [
              "lastNotNull"
            ]
          },
          "pieType": "pie",
          "tooltip": {
            "mode": "single"
          },
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "values": [
              "value",
              "percent"
            ]
          }
        }
      },
      {
        "id": 12,
        "type": "stat",
        "title": "Average Model Confidence",
        "description": "Average confidence score from gemma2:9b sentiment analysis (0.0-1.0)",
        "gridPos": {
          "h": 4,
          "w": 5,
          "x": 14,
          "y": 10
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  CAST(AVG(confidence)*100 AS NUMERIC(10,1)) as value\nFROM servicedesk.comment_sentiment\nWHERE created_time >= '2025-07-01';",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "red"
                },
                {
                  "value": 70,
                  "color": "yellow"
                },
                {
                  "value": 85,
                  "color": "green"
                }
              ]
            },
            "unit": "percent",
            "decimals": 1
          }
        },
        "options": {
          "graphMode": "area",
          "textMode": "value_and_name",
          "colorMode": "background"
        }
      },
      {
        "id": 13,
        "type": "stat",
        "title": "Total Comments Analyzed",
        "description": "Number of comments analyzed by gemma2:9b model",
        "gridPos": {
          "h": 4,
          "w": 5,
          "x": 19,
          "y": 10
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  COUNT(*) as value\nFROM servicedesk.comment_sentiment\nWHERE created_time >= '2025-07-01';",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "blue"
                }
              ]
            },
            "unit": "short"
          }
        },
        "options": {
          "graphMode": "area",
          "textMode": "value_and_name",
          "colorMode": "background"
        }
      },
      {
        "id": 14,
        "type": "bargauge",
        "title": "Sentiment Accuracy Comparison",
        "description": "Keyword (32%) vs LLM gemma2:9b (78%) accuracy based on 100-comment validation test",
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 0,
          "y": 14
        },
        "targets": [
          {
            "datasource": {
              "type": "testdata",
              "uid": "PD8C576611E62080A"
            },
            "scenarioId": "csv_content",
            "csvContent": "method,accuracy\nKeyword Baseline,32\ngemma2:9b LLM,78",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "red"
                },
                {
                  "value": 50,
                  "color": "yellow"
                },
                {
                  "value": 70,
                  "color": "green"
                }
              ]
            },
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        },
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "showUnfilled": true
        }
      },
      {
        "id": 101,
        "type": "row",
        "title": "Team Performance Ranking",
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 18
        },
        "collapsed": false
      },
      {
        "id": 5,
        "type": "table",
        "title": "Ranked Team Performance (Composite Score)",
        "description": "Team members ranked by composite score: SLA (30%) + Resolution Speed (30%) + Customer Sentiment (40%)",
        "gridPos": {
          "h": 12,
          "w": 24,
          "x": 0,
          "y": 19
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "WITH assignee_metrics AS (\n  SELECT\n    t.\"TKT-Assigned To User\" as assignee,\n    COUNT(DISTINCT t.\"TKT-Ticket ID\") as total_tickets,\n    SUM(CASE WHEN t.\"TKT-SLA Met\" = 'yes' THEN 1 ELSE 0 END)*100.0/COUNT(*) as sla_pct,\n    AVG(EXTRACT(EPOCH FROM (t.\"TKT-Actual Resolution Date\" - t.\"TKT-Created Time\"))/3600) as avg_resolution_hours\n  FROM servicedesk.tickets t\n  WHERE t.\"TKT-Team\" IN ('${team:raw}') AND t.\"TKT-Created Time\" >= '2025-07-01'\n  AND t.\"TKT-Assigned To User\" IS NOT NULL\n  AND t.\"TKT-SLA Met\" IS NOT NULL\n  GROUP BY t.\"TKT-Assigned To User\"\n  HAVING COUNT(*) >= 20\n),\nassignee_sentiment AS (\n  SELECT\n    t.\"TKT-Assigned To User\" as assignee,\n    SUM(CASE WHEN LOWER(c.comment_text) ~ '.*(thank|great|excellent|happy|appreciate|wonderful|fantastic|perfect|amazing).*' THEN 1 ELSE 0 END) as positive,\n    SUM(CASE WHEN LOWER(c.comment_text) ~ '.*(issue|problem|unhappy|frustrated|angry|disappointed|urgent|critical|error|fail).*' THEN 1 ELSE 0 END) as negative,\n    COUNT(*) as total_comments\n  FROM servicedesk.tickets t\n  INNER JOIN servicedesk.comments c ON t.\"TKT-Ticket ID\" = c.ticket_id\n  WHERE t.\"TKT-Team\" IN ('${team:raw}') AND t.\"TKT-Created Time\" >= '2025-07-01'\n  AND t.\"TKT-Assigned To User\" IS NOT NULL\n  AND c.visible_to_customer = 'Yes'\n  GROUP BY t.\"TKT-Assigned To User\"\n),\nscored AS (\n  SELECT\n    am.assignee,\n    am.total_tickets,\n    CAST(am.sla_pct AS NUMERIC(10,1)) as sla_percentage,\n    CAST(am.avg_resolution_hours AS NUMERIC(10,1)) as avg_hours,\n    COALESCE(asent.positive, 0) as positive_comments,\n    COALESCE(asent.negative, 0) as negative_comments,\n    COALESCE(asent.total_comments, 0) as total_comments,\n    CAST(\n      (am.sla_pct * 0.3) +\n      ((100 - LEAST(am.avg_resolution_hours, 100)) * 0.3) +\n      (CASE\n        WHEN COALESCE(asent.total_comments, 0) > 0\n        THEN ((COALESCE(asent.positive, 0) - COALESCE(asent.negative, 0))*100.0/asent.total_comments * 0.4)\n        ELSE 0\n      END)\n    AS NUMERIC(10,2)) as composite_score\n  FROM assignee_metrics am\n  LEFT JOIN assignee_sentiment asent ON am.assignee = asent.assignee\n  WHERE am.assignee NOT LIKE ' %'\n)\nSELECT\n  ROW_NUMBER() OVER (ORDER BY composite_score DESC) as \"Rank\",\n  assignee as \"Team Member\",\n  CAST(composite_score AS NUMERIC(10,1)) as \"Score\",\n  sla_percentage as \"SLA %\",\n  avg_hours as \"Avg Resolution (hrs)\",\n  total_tickets as \"Tickets\",\n  positive_comments as \"Positive\",\n  negative_comments as \"Negative\",\n  total_comments as \"Total Comments\"\nFROM scored\nORDER BY composite_score DESC\nLIMIT 20;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "align": "auto",
              "displayMode": "auto"
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Rank"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 80
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Score"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 100
                },
                {
                  "id": "custom.displayMode",
                  "value": "gradient-gauge"
                },
                {
                  "id": "color",
                  "value": {
                    "mode": "continuous-GrYlRd"
                  }
                }
              ]
            }
          ]
        },
        "options": {
          "showHeader": true,
          "footer": {
            "show": false
          }
        }
      },
      {
        "id": 102,
        "type": "row",
        "title": "Sentiment Analysis",
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 22
        },
        "collapsed": false
      },
      {
        "id": 6,
        "type": "barchart",
        "title": "Positive vs Negative Comments by Team Member (Top 15)",
        "description": "Customer sentiment breakdown showing positive and negative comment counts",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 23
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "WITH assignee_sentiment AS (\n  SELECT\n    t.\"TKT-Assigned To User\" as assignee,\n    SUM(CASE WHEN LOWER(c.comment_text) ~ '.*(thank|great|excellent|happy|appreciate|wonderful|fantastic|perfect|amazing).*' THEN 1 ELSE 0 END) as positive,\n    SUM(CASE WHEN LOWER(c.comment_text) ~ '.*(issue|problem|unhappy|frustrated|angry|disappointed|urgent|critical|error|fail).*' THEN 1 ELSE 0 END) as negative\n  FROM servicedesk.tickets t\n  INNER JOIN servicedesk.comments c ON t.\"TKT-Ticket ID\" = c.ticket_id\n  WHERE t.\"TKT-Team\" IN ('${team:raw}') AND t.\"TKT-Created Time\" >= '2025-07-01'\n  AND t.\"TKT-Assigned To User\" IS NOT NULL\n  AND c.visible_to_customer = 'Yes'\n  GROUP BY t.\"TKT-Assigned To User\"\n  HAVING COUNT(*) >= 50\n)\nSELECT\n  assignee as \"Team Member\",\n  positive as \"Positive\",\n  negative as \"Negative\"\nFROM assignee_sentiment\nWHERE assignee NOT LIKE ' %'\nORDER BY (positive + negative) DESC\nLIMIT 15;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "palette-classic"
            },
            "custom": {
              "axisCenteredZero": false,
              "axisLabel": "Comments",
              "axisPlacement": "auto",
              "fillOpacity": 80,
              "gradientMode": "none",
              "hideFrom": {
                "tooltip": false,
                "viz": false,
                "legend": false
              },
              "lineWidth": 1
            },
            "unit": "short"
          }
        },
        "options": {
          "legend": {
            "showLegend": true,
            "displayMode": "list",
            "placement": "bottom"
          },
          "tooltip": {
            "mode": "multi"
          },
          "orientation": "horizontal",
          "xTickLabelRotation": -45
        }
      },
      {
        "id": 7,
        "type": "timeseries",
        "title": "Sentiment Trend Over Time",
        "description": "Stacked area chart showing daily sentiment distribution (positive/neutral/negative) over 94 days. Reveals sentiment patterns and trends.",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 12,
          "y": 23
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  DATE(created_time) as time,\n  SUM(CASE WHEN LOWER(comment_text) ~ '.*(thank|great|excellent|happy|appreciate|wonderful|fantastic|perfect|amazing).*' THEN 1 ELSE 0 END) as \"Positive\",\n  SUM(CASE WHEN LOWER(comment_text) ~ '.*(issue|problem|unhappy|frustrated|angry|disappointed|urgent|critical|error|fail).*' THEN 1 ELSE 0 END) as \"Negative\",\n  COUNT(*) - SUM(CASE WHEN LOWER(comment_text) ~ '.*(thank|great|excellent|happy|appreciate|wonderful|fantastic|perfect|amazing|issue|problem|unhappy|frustrated|angry|disappointed|urgent|critical|error|fail).*' THEN 1 ELSE 0 END) as \"Neutral\"\nFROM servicedesk.comments\nWHERE visible_to_customer = 'Yes'\nAND created_time >= '2025-07-01'\nGROUP BY DATE(created_time)\nORDER BY time;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "palette-classic"
            },
            "custom": {
              "drawStyle": "line",
              "lineInterpolation": "smooth",
              "barAlignment": 0,
              "lineWidth": 2,
              "fillOpacity": 10,
              "gradientMode": "none",
              "spanNulls": false,
              "showPoints": "auto",
              "pointSize": 5,
              "stacking": {
                "mode": "normal",
                "group": "A"
              },
              "axisPlacement": "auto",
              "axisLabel": "Comments",
              "scaleDistribution": {
                "type": "linear"
              },
              "hideFrom": {
                "tooltip": false,
                "viz": false,
                "legend": false
              },
              "thresholdsStyle": {
                "mode": "off"
              }
            },
            "unit": "short"
          }
        },
        "options": {
          "legend": {
            "showLegend": true,
            "displayMode": "list",
            "placement": "bottom",
            "calcs": [
              "sum"
            ]
          },
          "tooltip": {
            "mode": "multi",
            "sort": "none"
          }
        }
      },
      {
        "id": 103,
        "type": "row",
        "title": "Quality Metrics",
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 31
        },
        "collapsed": false
      },
      {
        "id": 8,
        "type": "bargauge",
        "title": "SLA Compliance by Team Member (Top 15)",
        "description": "SLA compliance percentage for top performing team members",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 32
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  \"TKT-Assigned To User\" as \"Team Member\",\n  CAST(SUM(CASE WHEN \"TKT-SLA Met\" = 'yes' THEN 1 ELSE 0 END)*100.0/COUNT(*) AS NUMERIC(10,1)) as \"SLA %\"\nFROM servicedesk.tickets\nWHERE \"TKT-Team\" IN ('${team:raw}') AND \"TKT-Created Time\" >= '2025-07-01'\nAND \"TKT-Assigned To User\" IS NOT NULL\nAND \"TKT-SLA Met\" IS NOT NULL\nAND \"TKT-Assigned To User\" NOT LIKE ' %'\nGROUP BY \"TKT-Assigned To User\"\nHAVING COUNT(*) >= 50\nORDER BY \"SLA %\" DESC\nLIMIT 15;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "red"
                },
                {
                  "value": 85,
                  "color": "yellow"
                },
                {
                  "value": 95,
                  "color": "green"
                }
              ]
            },
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        },
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "showUnfilled": true
        }
      },
      {
        "id": 9,
        "type": "bargauge",
        "title": "Average Resolution Time by Team Member (Top 15)",
        "description": "Average ticket resolution time in hours (lower is better)",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 12,
          "y": 32
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  \"TKT-Assigned To User\" as \"Team Member\",\n  CAST(AVG(EXTRACT(EPOCH FROM (\"TKT-Actual Resolution Date\" - \"TKT-Created Time\"))/3600) AS NUMERIC(10,1)) as \"Avg Hours\"\nFROM servicedesk.tickets\nWHERE \"TKT-Team\" IN ('${team:raw}') AND \"TKT-Created Time\" >= '2025-07-01'\nAND \"TKT-Assigned To User\" IS NOT NULL\nAND \"TKT-Actual Resolution Date\" IS NOT NULL\nAND \"TKT-Assigned To User\" NOT LIKE ' %'\nGROUP BY \"TKT-Assigned To User\"\nHAVING COUNT(*) >= 50\nORDER BY \"Avg Hours\" ASC\nLIMIT 15;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "value": null,
                  "color": "green"
                },
                {
                  "value": 48,
                  "color": "yellow"
                },
                {
                  "value": 72,
                  "color": "red"
                }
              ]
            },
            "unit": "h",
            "min": 0,
            "max": 150
          }
        },
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "showUnfilled": true
        }
      },
      {
        "id": 104,
        "type": "row",
        "title": "Customer Feedback",
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 40
        },
        "collapsed": false
      },
      {
        "id": 10,
        "type": "table",
        "title": "Recent Positive Customer Comments",
        "description": "Latest customer-facing comments with positive sentiment",
        "gridPos": {
          "h": 10,
          "w": 12,
          "x": 0,
          "y": 41
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  c.created_time as \"Date\",\n  t.\"TKT-Ticket ID\" as \"Ticket\",\n  t.\"TKT-Assigned To User\" as \"Assignee\",\n  LEFT(c.comment_text, 100) || '...' as \"Comment Excerpt\"\nFROM servicedesk.comments c\nINNER JOIN servicedesk.tickets t ON c.ticket_id = t.\"TKT-Ticket ID\"\nWHERE c.visible_to_customer = 'Yes'\nAND c.created_time >= '2025-07-01'\nAND LOWER(c.comment_text) ~ '.*(thank|great|excellent|happy|appreciate|wonderful|fantastic|perfect|amazing).*'\nORDER BY c.created_time DESC\nLIMIT 50;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "align": "auto",
              "displayMode": "auto"
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Date"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 180
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Ticket"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 100
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Assignee"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 150
                }
              ]
            }
          ]
        },
        "options": {
          "showHeader": true,
          "footer": {
            "show": false
          }
        }
      },
      {
        "id": 11,
        "type": "table",
        "title": "Recent Negative/Issue Comments",
        "description": "Latest customer-facing comments with negative sentiment or issues",
        "gridPos": {
          "h": 10,
          "w": 12,
          "x": 12,
          "y": 41
        },
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "${datasource}"
            },
            "format": "table",
            "rawSql": "SELECT\n  c.created_time as \"Date\",\n  t.\"TKT-Ticket ID\" as \"Ticket\",\n  t.\"TKT-Assigned To User\" as \"Assignee\",\n  LEFT(c.comment_text, 100) || '...' as \"Comment Excerpt\"\nFROM servicedesk.comments c\nINNER JOIN servicedesk.tickets t ON c.ticket_id = t.\"TKT-Ticket ID\"\nWHERE c.visible_to_customer = 'Yes'\nAND c.created_time >= '2025-07-01'\nAND LOWER(c.comment_text) ~ '.*(issue|problem|unhappy|frustrated|angry|disappointed|urgent|critical|error|fail).*'\nORDER BY c.created_time DESC\nLIMIT 50;",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "align": "auto",
              "displayMode": "auto"
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Date"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 180
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Ticket"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 100
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Assignee"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 150
                }
              ]
            }
          ]
        },
        "options": {
          "showHeader": true,
          "footer": {
            "show": false
          }
        }
      }
    ],
    "templating": {
      "list": [
        {
          "name": "datasource",
          "label": "Data Source",
          "type": "datasource",
          "query": "postgres",
          "current": {
            "value": "ServiceDesk PostgreSQL",
            "text": "ServiceDesk PostgreSQL"
          }
        },
        {
          "name": "team",
          "label": "Team",
          "type": "custom",
          "query": "All,Cloud - Infrastructure,Cloud - Security,Cloud - L3 Escalation",
          "current": {
            "selected": true,
            "text": [
              "All"
            ],
            "value": [
              "All"
            ]
          },
          "options": [
            {
              "selected": true,
              "text": "All",
              "value": "All"
            },
            {
              "selected": false,
              "text": "Cloud - Infrastructure",
              "value": "Cloud - Infrastructure"
            },
            {
              "selected": false,
              "text": "Cloud - Security",
              "value": "Cloud - Security"
            },
            {
              "selected": false,
              "text": "Cloud - L3 Escalation",
              "value": "Cloud - L3 Escalation"
            }
          ],
          "multi": true,
          "includeAll": true,
          "allValue": "Cloud - Infrastructure','Cloud - Security','Cloud - L3 Escalation",
          "hide": 0,
          "skipUrlSync": false
        }
      ]
    }
  },
  "folderId": 0,
  "overwrite": true
}