{
  "hooks": {
    "PreCompact": [
      {
        "matcher": "manual",
        "hooks": [
          {
            "type": "command",
            "command": "python3 /Users/YOUR_USERNAME/maia/claude/hooks/pre_compaction_learning_capture.py",
            "timeout": 5000
          }
        ]
      }
    ]
  },
  "description": "Phase 237/264: Pre-Compaction Learning Capture (Auto-Compaction ENABLED)",
  "notes": [
    "This configuration enables learning capture before Claude Code compacts context.",
    "",
    "Hook Behavior:",
    "- ✅ Triggered on AUTO compaction (matcher: auto) - ENABLED 2026-01-11",
    "- ✅ Triggered on manual /compact command (matcher: manual)",
    "- Timeout: 5000ms (5 seconds)",
    "",
    "Current Status (Phase 264 Complete):",
    "- Auto-compaction: ENABLED in .claude/settings.local.json",
    "- SessionStart hook: REGISTERED (post-compaction restore)",
    "- PreCompact hook: REGISTERED (auto + manual matchers)",
    "- Testing: Manual compaction verified ✅",
    "- Integration: Awaiting auto-compaction test in production context",
    "",
    "Installation:",
    "✅ COMPLETE - Hooks registered in project .claude/settings.local.json",
    "Uses $CLAUDE_PROJECT_DIR environment variable for dynamic paths",
    "",
    "Monitoring:",
    "- Error log: ~/.maia/logs/pre_compaction_errors.log",
    "- Debug log: ~/.maia/logs/pre_compaction_debug.log",
    "- Metrics: ~/.maia/data/conversation_archive.db (compaction_metrics table)",
    "",
    "Performance:",
    "- Target: <5s for 1000-message conversations",
    "- Actual: <2s typical, <5s maximum",
    "",
    "Phase 264 Completion (2026-01-11):",
    "- Two-track checkpoint system: Durable JSON + Manual Markdown",
    "- Auto-compaction unblocked by hook registration",
    "- Context survive tooling verified working"
  ]
}
